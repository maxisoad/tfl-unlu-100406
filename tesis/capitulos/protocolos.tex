\chapter{Protocolos Web}
\label{protocolos}
\section{Definici'on}
FALTA: INTRODUCCION, DEFINICION DE PROTOCOLOS WEB, MODELO OSI, ETC

\section{HTTP}

Las siglas de este protocolo son por HyperText Transfer Protocol (Protocolo de Transferencia de Hipertexto). Es un protocolo de capa de aplicaci'on\footnote{PONER ACA ALGO DEL MODELO OSI} que sirve para distribuir informaci'on. Fu'e utilizado en la Web desde el a'no 1990 en su primera versi'on (0.9), en la que simplemente se pod'ia transferir texto plano. Su evoluci'on fue el est'andar 1.0 en el que se mejor'o el protocolo permitiendo que los mensajes usen el formato \gls{mime}, se incorporaron metadatos acerca de la informaci'on transferida y modificadores en la sem'antica de petici'on/respuesta. La revisi'on del protocolo que se usa actualmente es la 1.1, definida en la RFC1626\citep{rfcHTTP1.1}. Contiene nuevos metodos, headers y otras caracter'isticas. Las principales diferencias de esta 'ultima definici'on se pueden ver en \citep{http1011}.

El contenido web reside en Servidores, estos son los que se comunican utilizando este protocolo entre otros. Sirven \textsc{recursos}, estos recursos pueden ser p'aginas HTML, im'agenes, PDF's, video, etc, tanto contenido est'atico como din'amico (generado a demanda). Debido a la gran diversidad de contenido que provee un Servidor, es necesario identificar el tipo de recurso que se est'a enviando. Esto se hace utilizando una etiqueta llamada MIME-Type, que define el tipo de contenido a transferir.

Cada recurso del servidor tiene un nombre, para que los clientes puedan apuntar directamente al recurso deseado. Se nombra con una URL, que tiene el siguiente formato:

\begin{quote}
PROTOCOLO://SERVIDOR/PATH\_AL\_RECURSO/RECURSO
\end{quote}

El funcionamiento b'asico es, el cliente env'ia una petici'on al Servidor (al puerto 80 por defecto) y este le responde. Esta comunicaci'on se realiza a trav'ez de mensajes HTTP. Existen diferentes m'etodos que se pueden utilizar cuando se env'ia una petici'on al servidor, tales como

\begin{enumerate}
\item GET - El cliente solicita un recurso espec'ifico del servidor.
\item POST - El cliente env'ia datos que van a ser utilizados por el servidor.
\item HEAD - El cliente solicita s'olo los Headers (se detallar'an m'as adelante).
\end{enumerate}

Estos son algunos de los m'etodos, hay otros tales como PUT, DELETE, etc. Seg'un el m'etodo, el servidor opera de manera diferente. En la petici'on se env'ia el m'etodo, el recurso solicitado, la versi'on del protocolo utilizado, el host, el user-agent\footnote{Qui'en est'a generando la petici'on, por ejemplo Mozilla o Safari (browser, proxy, etc.).}, entre otros.
El Servidor, responde a la petici'on con una respuesta, que contiene un c'odigo de estado de 3 d'igitos que le dice al cliente que la petici'on fue exitosa u otras, por ejemplo 200 (OK) o 404 (Documento no encontrado) de los m'as comunes.

Los mensajes de HTTP consisten en peticiones y respuestas, sus formatos son similares. Consisten en 3 partes:

\begin{enumerate}
\item Linea Inicial - Se indica que hacer en la petici'on o que fue lo que pas'o en la respuesta.
\item Headers - Ac'a se pueden definir diferentes par'ametros por c'ada l'inea con la sintaxis ''nombre:valor''.
\item Cuerpo - Esta parte contiene los datos enviados, ya sea del cliente al servidor o viceversa.
\end{enumerate}

El formato de una petici'on es el siguiente:

\begin{quote}
$<$m'etodo$>$ $<$url del recurso$>$ $<$versi'on$>$

$<$headers$>$

$<$cuerpo$>$
\end{quote}

El formato de la respuesta es el siguiente:

\begin{quote}
$<$versi'on$>$ $<$estado$>$ $<$descripci'on del estado$>$

$<$headers$>$

$<$cuerpo$>$
\end{quote}

\subsection{HEADERS}
\label{headers}
Los Headers, a'naden informacion adicional a las peticiones y respuestas. El protocolo define varios Headers, pero se pueden inventar tambi'en, los servidores y clientes son libres de hacerlo. Hay diferentes tipos de Headers, entre los que se encuentran:

\begin{enumerate}
\item Headers Generales

Pueden aparecer en peticiones y respuestas.
\item Headers de Peticiones.

Proveen m'as informaci'on acerca de las peticiones.
\item Headers de respuesta.

Proveen m'as informaci'on acerca de las respuestas.
\item Entity Headers (ENTIDAD?)

Proveen informaci'on acerca del recurso del mensaje.
\item Headers de Extensi'on

Permite agregar nuevos headers que no est'en dentro de la especificaci'on.\footnote{PONER LA ESPECIFICACION}
\end{enumerate}

La definici'on completa de los Headers se encuentra en la Secci''on 14 de \citep{rfcHTTP1.1}.

\section{HTTPS}

Este protocolo, es la versi'on ''segura'' de HTTP, a diferencia de este protocolo, a'nade una capa de cifrado utilizando SSL/TLS sobre TCP. Esto permite que los datos que viajen entre cliente y servidor vayan encriptados, esto se hace antes de enviar los datos por la red. Se distingue f'acilmente porque el formato de la URL empieza con https:// y la conexi'on se hace por el puerto 443 por defecto. Es decir, cuando el browser hace una petici'on a un servidor, si el esquema es https, inicia la conexi'on segura con el servidor.

La conexi'on se hace con otro puerto diferente al de HTTP ya que SSL es un protocolo binario, completamente diferente. Si ambos llegaran al mismo puerto, los servidores interpretarian SSL como HTTP err'oneo y cerrar'ian la conexi'on.

El procedimiento para iniciar la conexi'on es el siguiente: El cliente abre una conexi'on con el puerto 443 al servidor. Una vez que la conexi'on TCP est'a establecida, el cliente y el servidor inicializan la capa SSL negociando algunos par'ametros criptogr'aficos e intercambiando llaves. Una vez concluida esta negociaci'on, ya pueden empezar a intercambiar mensajes encriptados.

\section{SPDY}

Es un protocolo de aplicaci'on que a'nade una capa de sesi'on sobre SSL que permite la transmisi'on de m'ultiples Streams\footnote{Flujo de Datos.} sobre una conexi'on TCP. Especifica un nuevo formato de trama para codificar y transmitir datos.
Su especificaci'on se puede ver en \citep{spdyWhitepaper} y su draft se puede encontrar en \citep{spdyDraft}.

El protocolo HTTP no tiene estado, y, por cada recurso existe la necesidad de abrir una conexi'on nueva y cerrarla. Esto trae varios problemas. Por cada conexi'on nueva que se hace, se necesitan varios mensajes para establecer la conexi'on TCP, lo que trae varios RTT adicionales a la comunicaci'on. Retrasos debido al ''Slow Start''\footnote{Se comienza enviando un volumen de datos pequeño hasta alcanzar cierto valor llamado Umbral de Congesti'on} de TCP. Clientes que evitan realizar m'ultiples conexiones con el mismo servidor (hasta 6 actualmente PONER REF). A su vez, los servidores crean varios subdominios para almacenar el contenido para que los clientes puedan realizar las peticiones sin tener que evitar las m'ultiples conexiones a un mismo dominio.

SPDY ofrece por sobre HTTP las siguientes mejoras:

\begin{enumerate}
\item Peticiones Multiplexadas. No existen l'imites de peticiones que se pueden realizar en una sesi'on de SPDY. A causa de que las peticiones son multiplexadas aumenta la eficiencia del protocolo TCP.
\item Priorizaci'on de Peticiones. Los clientes pueden solicitar al servidor cu'ales recursos quiere obtener antes que otros. Esto evita la congesti'on de recursos que no son cr'iticos cuando todav'ia est'a pendiente el env'io de algun recurso que tiene una prioridad mayor.
\item Compresi'on de Headers. A causa de que hoy en d'ia los clientes env'ian mucha informaci'on redundante en forma de Headers, como la cantidad de peticiones para obtener un sitio promedio va desde 50 a 100, esta cantidad de informaci'on es relevante. Comprimir los Headers reduce el ancho de banda utilizado.
\item Server Push. Al permitir la comunicaci'on bi-direccional a trav'ez de streams, cualquiera de los 2 (cliente o servidor) puede iniciar un stream hacia el otro. El servidor puede enviar un recurso al cliente antes de que este lo pida\footnote{El servidor conoce de antemano que el cliente va a necesitar el recurso en cuesti'on.}, esto reduce el tiempo de carga del sitio y disminuye la cantidad de peticiones del cliente.
\item Server Hint. El servidor puede ''sugerirle'' al cliente que pida un recurso en particular, ya que lo va a necesitar. De todas maneras, el servidor espera a que el cliente peticione el recurso en cuesti'on antes de enviarlo. Esto reduce el tiempo que tarda el cliente en descubrir cuales son los recursos que tiene que pedirle al servidor.
\end{enumerate}

SPDY se enfoca en la manera en la que se transmiten los datos por la red, preserva toda la sem'antica del protocolo HTTP. De esta manera, para las aplicaciones se implementa de manera transparente, ya que reside entre la capa de aplicaci'on y la de transporte. Esta sesi'on es similar al par petici'on-respuesta de HTTP. Es obligatoria la compresi'on del mensaje.